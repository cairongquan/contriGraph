function t(t,a){return new Date(Date.parse(t+`-${a}-01`)).getDay()}function a(t,a){const e=new Date(t);e.setDate(e.getDate()+a);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}const e=t=>{const a=isNaN(t)?0:Number(t);return 0===a?"#1e1f2a":a<=5?"#c6e48b":a<=10?"#7bc96f":"#2dce49"};class s{constructor(t){this.canvas=null,this.svg=null,this.canvasDom=null,this.width=0,this.height=0;const{canvas:a,svg:s,size:i=10,gapSize:r=5,data:n={},colorParse:h,year:c}=t;if(a instanceof HTMLCanvasElement)this.isSvgOrCanvas="canvas",this.canvas=a.getContext("2d"),this.canvasDom=a;else{if(!(s instanceof SVGElement))throw new Error("miss required param: canvas or svg");this.isSvgOrCanvas="svg",this.svg=s}this.size=i,this.gapSize=r,this.data=n,this.colorParse="function"==typeof h&&h||e,this.year=c||(new Date).getFullYear()}render(t){t?this.renderMonth(t):this.renderYear()}createCanvas(t,a,e){null!==this.canvas&&(this.canvas.fillStyle=e,this.canvas.fillRect(t*(this.size+this.gapSize),a*(this.size+this.gapSize),this.size,this.size))}renderMonth(e){const s=function(t,a){return 12===a?31:Math.trunc(Math.ceil(Date.parse(t+`-${a+1}`)-Date.parse(t+`-${a}`))/864e5)}(this.year,e),i=t(this.year,e),r=new Array(i).fill(0).concat(new Array(s).fill(1));let n=`${this.year}-${String(e).padStart(2,"0")}-01`;this.getSizeOfCanvas(r.length),r.forEach(((t,e)=>{const s=Math.floor(e/7),i=e%7;let r="";0!==t?(r=r=this.colorParse(this.data[n]?this.data[n]:0),n=a(n,1)):r="rgba(255, 0, 255, 0)",this.createCanvas(s,i,r)}))}renderYear(){const e=t(this.year,1),s=(i=this.year,Math.trunc(Math.ceil(Date.parse(`${i+1}-1-31`)-Date.parse(`${i}-1-31`)))/864e5);var i;const r=new Array(e).fill(0).concat(new Array(s).fill(1));let n=`${this.year}-01-01`;this.getSizeOfCanvas(r.length),r.forEach(((t,e)=>{const s=Math.floor(e/7),i=e%7;let r="";0!==t?(r=this.colorParse(this.data[n]?this.data[n]:0),n=a(n,1)):r="rgba(255, 0, 255, 0)",this.createCanvas(s,i,r)}))}getSizeOfCanvas(t){if("canvas"===this.isSvgOrCanvas){const a=Math.ceil(t/7),e=7;this.width=a*this.size+(a-1)*this.gapSize,this.height=e*this.size+(e-1)*this.gapSize,this.canvasDom.width=this.width,this.canvasDom.height=this.height}}}export{s as default};
